<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collezioni e Prodotti | GRANFO</title>
    <meta name="description" content="Lampade artigianali su misura. Sospensioni, lampade da tavolo e soluzioni architetturali made in Italy.">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <meta property="og:description" content="Artigiani della luce dal 1970. Scopri le nostre collezioni in vetro di Murano e design su misura.">
<meta property="og:image" content="https://tuosito.com/images/hero/hero-main-graphic.webp"> <meta property="og:url" content="https://tuosito.com">
<meta property="og:type" content="website">

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;1,400&family=Segoe+UI:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* Preloader critico per evitare flash iniziale */
        #preloader { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; background: #0e1713; z-index: 99999; opacity: 1; visibility: visible; transition: opacity 0.3s ease, visibility 0.3s ease; }
        #preloader.loaded { opacity: 0; visibility: hidden; pointer-events: none; }
        .preloader-icon { width: 120px; height: auto; animation: breathe 2s infinite ease-in-out; }
        @keyframes breathe { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.7; } }
    </style>
</head>
<body>
    <script>document.documentElement.style.visibility='hidden';</script>
    <div id="preloader">
        <img src="./images/brand/granfoluce-logo.png" alt="GRANFOLUCE" class="preloader-icon">
    </div>
    <script>
        const hidePreloader = () => {
            document.documentElement.style.visibility = 'visible';
            const preloader = document.getElementById('preloader');
            if (preloader && !preloader.classList.contains('loaded')) {
                preloader.classList.add('loaded');
            }
        };
        window.addEventListener('load', () => {
            requestAnimationFrame(() => {
                setTimeout(hidePreloader, 80);
            });
        });
        setTimeout(hidePreloader, 3000);
    </script>

    <nav class="navbar">
        <div class="container nav-container">
            <a href="index.html" class="logo"><img src="./images/brand/granfoluce-logo.png" alt="GRANFOLUCE" style="height: 50px;"></a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="cataloghi.html">Cataloghi</a></li>
                <li><a href="prodotti.html" class="active">Prodotti</a></li>
                <li><a href="aurum.html">Domus</a></li>
                <li><a href="progetti.html">Progetti</a></li>
                <li><a href="chi-siamo.html">Chi Siamo</a></li>
                <li><a href="contatti.html">Contatti</a></li>
            </ul>
            <div class="nav-actions">
                <button class="icon-btn" onclick="toggleSearch()" aria-label="Cerca"><svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <div class="lang-selector"><a href="#" class="lang-item active">IT</a><a href="en/products.html" class="lang-item">EN</a></div>
                <button class="menu-toggle" onclick="toggleMenu()" aria-label="Menu"><span></span><span></span><span></span></button>
            </div>
        </div>
        <div id="mobile-menu" class="mobile-menu">
            <a href="index.html">Home</a>
            <a href="cataloghi.html">Cataloghi</a>
            <a href="prodotti.html">Prodotti</a>
            <a href="aurum.html">Domus</a>
            <a href="progetti.html">Progetti</a>
            <a href="chi-siamo.html">Chi Siamo</a>
            <a href="contatti.html">Contatti</a>
        </div>
    </nav>

    <div id="search-overlay" class="search-overlay">
        <button class="close-search" onclick="toggleSearch()">✕</button>
        <div class="search-container"><input type="text" placeholder="Cerca..." autofocus></div>
    </div>

    <header class="page-header">
        <div class="page-header-bg"><img src="images/prodotti/copertina-prodotti.webp" alt="Prodotti Granfo Luce"></div>
        <div class="container page-title">
            <p class="breadcrumb"><a href="index.html">Home</a> / <span>Prodotti</span></p>
            <h1>Le Collezioni</h1>
        </div>
    </header>

    <section class="aurum-banner">
    <div class="container aurum-banner-content">
        <div class="aurum-text">
            <h2>Collezione Domus</h2>
            <p>L'eleganza dell'ottone e il minimalismo delle forme.</p>
        </div>
        <div style="display: flex; justify-content: center;">
            <a href="aurum.html" class="btn btn-gold">Scopri</a>
        </div>
    </div>
</section>

   <section class="section-padding" id="catalogo" style="padding-top: 2rem;">
    <div class="container">
        
        <div class="filters-bar" style="margin-bottom: 1rem;">
            <div class="scroller-track">
                <button class="chip active" onclick="filterProducts('all', this)">Tutti</button>
                <button class="chip" onclick="filterProducts('sospensione', this)">Sospensione</button>
                <button class="chip" onclick="filterProducts('tavolo', this)">Tavolo</button>
                <button class="chip" onclick="filterProducts('soffitto', this)">Soffitto</button>
                <button class="chip" onclick="filterProducts('parete', this)">Parete</button>
                <button class="chip" onclick="filterProducts('terra', this)">Terra</button>
                <button class="chip" onclick="filterProducts('vasi e oggettistica', this)">Oggettistica</button>
                <button class="chip" onclick="filterProducts('outdoor', this)">Outdoor</button>
            </div>
        </div>

        <div class="trust-icons-row">
            <div class="trust-bar-scroll">
            <div class="trust-item">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"></path></svg>
            <span>Made in Italy</span>
            </div>
            <div class="trust-item">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg>
            <span>Vetro di Murano</span>
            </div>
            <div class="trust-item">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
            <span>Garanzia 5 Anni</span>
            </div>
            <div class="trust-item">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <span>Spedizioni Globali</span>
            </div>
            <div class="trust-item">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <span>Lavorazione Artigianale</span>
            </div>
       </div>
        

        <p class="results-count" id="results-count" style="margin-top: 1rem;"></p>

        <div class="products-page-grid reveal" id="product-grid">
            
            <div class="product-item" data-category="sospensione" data-price="low" data-material="vetro" data-product-id="fungo-black" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                <img src="images/prodotti/sospensione/fungonero.webp" alt="Lampada Sospensione Fungo" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Fungo Black</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Sospensione in metallo</p>
                </div>
            </div>

            <div class="product-item" data-category="sospensione" data-price="medium" data-material="oro" data-product-id="luxe-table" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                <img src="images/prodotti/Sospensione/barra.webp" alt="Sospensione Barra" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Luxe Table</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Tavolo finitura oro</p>
                </div>
            </div>

             <div class="product-item" data-category="sospensione" data-price="high" data-material="metallo" data-product-id="applique-modern" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                <img src="images/prodotti/sospensione/sospvetro.webp" alt="Sospensione in vetro" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Applique Modern</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Design geometrico</p>
                </div>
            </div>

            <div class="product-item" data-category="sospensione" data-price="medium" data-material="metallo" data-product-id="garden-light" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                <img src="images/prodotti/sospensione/tubo.webp" alt="Sospensione Tubo" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Garden Light</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Resistente all'acqua</p>
                </div>
            </div>

            <div class="product-item" data-category="sospensione" data-price="medium" data-material="metallo" data-product-id="garden-light" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                <img src="images/prodotti/sospensione/sospcoll.webp" alt="Sospensione Collana" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Garden Light</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Resistente all'acqua</p>
                </div>
            </div>
            
             <div class="product-item" data-category="sospensione" data-price="high" data-material="metallo" data-line="aurum" data-product-id="sospensione-aurum" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist" title="Aggiungi alla Wishlist">
                    <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                </button>
                <img src="images/prodotti/Sospensione/sospensione-aurum.webp" alt="Sospensione Domus" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Sospensione Domus</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Vetro di Murano - Cristallo</p>
                </div>
            </div>

            <div class="product-item" data-category="tavolo" data-price="medium" data-material="metallo" data-product-id="garden-light" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                <img src="images/prodotti/Tavolo/tavolocubo.webp" alt="Tavolo Cubo" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Garden Light</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Resistente all'acqua</p>
                </div>
            </div>

            <div class="product-item" data-category="tavolo" data-price="medium" data-material="metallo" data-line="aurum" data-product-id="tavolo-lastra" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                <img src="images/prodotti/Tavolo/vetri-lastra.webp" alt="Tavolo Lastra" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Tavolo Lastra</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Finitura ottone</p>
                </div>
            </div>

            <div class="product-item" data-category="terra" data-price="medium" data-material="metallo" data-product-id="garden-light" data-note="Nota: Per maggiori informazioni e varianti contattaci.">
                <button class="wishlist-btn" aria-label="Aggiungi alla wishlist"><svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></button>
                <img src="images/prodotti/Terra/terralight.webp" alt="Terra Light" onclick="openLightbox(this.src)" style="cursor: pointer;">
                <div class="p-3">
                    <h3>Garden Light</h3>
                    <p style="color:var(--color-text-muted); font-size:0.9rem;">Resistente all'acqua</p>
                </div>
            </div>

        </div>
    </div>
</section>

<div class="filter-overlay" id="filter-overlay" onclick="toggleFilters()"></div>
<div class="filter-sheet" id="filter-sheet">
    <div class="filter-header">
        <h3>Filtra Prodotti</h3>
        <button class="close-filter" onclick="toggleFilters()">✕</button>
    </div>
    <div class="filter-content">
        <div class="filter-group">
            <h4>Prezzo</h4>
            <label><input type="checkbox" value="low" onchange="applyAdvancedFilters()"> €0 - €200</label>
            <label><input type="checkbox" value="medium" onchange="applyAdvancedFilters()"> €200 - €500</label>
            <label><input type="checkbox" value="high" onchange="applyAdvancedFilters()"> €500+</label>
        </div>
        <div class="filter-group">
            <h4>Materiale</h4>
            <label><input type="checkbox" value="vetro" onchange="applyAdvancedFilters()"> Vetro Soffiato</label>
            <label><input type="checkbox" value="metallo" onchange="applyAdvancedFilters()"> Metallo</label>
            <label><input type="checkbox" value="oro" onchange="applyAdvancedFilters()"> Finitura Oro</label>
        </div>
    </div>
    <div class="filter-footer">
        <button class="btn btn-gold w-full" onclick="toggleFilters()">Vedi Risultati</button>
    </div>
</div>

    <section class="section-padding" id="wishlist" style="display:none; padding-top:2rem;">
        <div class="container">
            <div class="section-header">
                <div><span class="eyebrow">Preferiti</span><h2>La tua Wishlist</h2></div>
            </div>
            <div class="wishlist-actions" style="display:flex; gap:0.75rem; flex-wrap:wrap; margin-bottom:1rem;">
                <button class="btn btn-gold" onclick="sendWishlist('whatsapp')" style="padding:0.8rem 1.4rem;">Invia via WhatsApp</button>
                <button class="btn btn-outline" onclick="sendWishlist('mail')" style="padding:0.8rem 1.4rem;">Invia via Email</button>
            </div>
            <div class="products-page-grid reveal" id="wishlist-grid"></div>
            <p class="results-count" id="wishlist-empty" style="margin-top:1rem;">Nessun prodotto in wishlist.</p>
        </div>
    </section>

   
 <footer class="footer">
        <div class="container footer-grid">
            <div class="footer-col brand-col">
                <a href="index.html" class="footer-logo"><img src="./images/brand/granfoluce-logo.png" alt="GRANFOLUCE" style="height: 60px;"></a>
                <p class="copyright">© 2025 GRANFO ILLUMINAZIONE S.N.C.<br>All Rights Reserved.</p>
                <div class="social-icons">
                    <a href="https://www.facebook.com/Granfoluce.lampadari/?locale=it_IT" aria-label="Facebook" target="_blank" rel="noopener noreferrer"><svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"></path></svg></a>
                    <a href="https://www.instagram.com/granfoluce/" aria-label="Instagram"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"></path></svg></a>
                    <a href="https://it.pinterest.com/granfolucefb/" aria-label="Pinterest"><svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.399.165-1.487-.69-2.435-2.844-2.435-4.576 0-3.719 2.703-7.149 7.808-7.149 4.105 0 7.292 2.925 7.292 6.829 0 4.075-2.57 7.356-6.138 7.356-1.2 0-2.324-.623-2.707-1.36l-.738 2.803c-.266 1.015-.99 2.278-1.477 3.05 1.11.343 2.296.529 3.518.529 6.618 0 11.996-5.383 11.996-12.004C24.013 5.367 18.636 0 12.017 0z"/></svg></a>
                    <a href="https://www.youtube.com/@granfoluce3774/shorts" aria-label="YouTube"><svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg></a>
                </div>
            </div>
            <div class="footer-col">
                <h4>MENU</h4>
                <ul>
                    <li><a href="chi-siamo.html">Chi Siamo</a></li>
                    <li><a href="prodotti.html">Prodotti</a></li>
                    <li><a href="contatti.html">Contattaci</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>INFO</h4>
                <div class="footer-text-group">
                    <p>GRANFO ILLUMINAZIONE S.N.C.</p>
                    <p>P.IVA 01410980237</p>
                    <a href="privacy-policy.html" class="privacy-link">Privacy Policy</a>
                </div>
            </div>
            <div class="footer-col">
                <h4>CONTATTI</h4>
                <div class="contact-rows">
                    <p><span class="label">Email:</span><br><a href="mailto:info@granfoluce.it" class="highlight-link">info@granfoluce.it</a></p>
                    <p><span class="label">Telefono:</span><br><a href="tel:+39045528541" class="highlight-link">+39 045 528541</a></p>
                    <p><span class="label">Indirizzo:</span><br><a href="https://maps.google.com" target="_blank" class="highlight-link underline">via Ponte S. Pancrazio 8 Verona</a></p>
                </div>
            </div>
        </div>
    </footer>


    <script>
        function toggleMenu() { document.getElementById('mobile-menu').classList.toggle('active'); document.body.classList.toggle('no-scroll'); }
        function toggleSearch() { const overlay = document.getElementById('search-overlay'); overlay.classList.toggle('active'); if(overlay.classList.contains('active')) setTimeout(() => overlay.querySelector('input').focus(), 100); }
        const revealElements = document.querySelectorAll('.reveal');
        const revealObserver = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('active'); } }); }, { threshold: 0.1 });
        revealElements.forEach(el => revealObserver.observe(el));
        /* --- LOGICA FILTRI --- */
let activeCategory = 'all';
let activeSearchQuery = '';

function toggleFilters() {
    const sheet = document.getElementById('filter-sheet');
    const overlay = document.getElementById('filter-overlay');
    sheet.classList.toggle('active');
    overlay.classList.toggle('active');
    if(sheet.classList.contains('active')) document.body.style.overflow = 'hidden';
    else document.body.style.overflow = '';
}

// Filtro rapido per categoria (bottoni in alto)
function filterProducts(category, btnElement) {
    activeCategory = category;
    
    // Aggiorna stile bottoni
    document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
    if (btnElement) btnElement.classList.add('active');

    applyAdvancedFilters(); // Richiama la funzione principale che combina tutto
}

// Auto-filtra in base al parametro URL
window.addEventListener('load', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const categoria = urlParams.get('categoria');
    const q = urlParams.get('q');
    if (categoria) {
        const btn = Array.from(document.querySelectorAll('.chip')).find(c => c.textContent.toLowerCase().includes(categoria.toLowerCase()) || c.getAttribute('onclick')?.includes(categoria));
        if (btn) {
            filterProducts(categoria, btn);
        }
    }
    if (q) {
        activeSearchQuery = q;
        const overlay = document.getElementById('search-overlay');
        const input = overlay ? overlay.querySelector('input') : null;
        if (input) input.value = q;
        applyAdvancedFilters();
    }

    // Se arrivo con un anchor, scrolla al target (preferibilmente catalogo per vedere i filtri)
    const hash = window.location.hash;
    if (hash) {
        setTimeout(() => {
            const targetId = hash.replace('#','');
            let target = document.getElementById(targetId);
            if (!target && (hash === '#product-grid' || hash === '#catalogo')) {
                target = document.getElementById('catalogo') || document.getElementById('product-grid');
            }
            if (target) {
                const offset = 90; // lascia spazio per navbar e chip
                const top = target.getBoundingClientRect().top + window.scrollY - offset;
                window.scrollTo({ top, behavior: 'smooth' });
            }
        }, 120);
    }
});

// Logica combinata (Categoria + Checkbox Prezzo/Materiale)
function applyAdvancedFilters() {
    const products = document.querySelectorAll('.product-item');
    let visibleCount = 0;

    // Prendi i valori delle checkbox selezionate
    const priceFilters = Array.from(document.querySelectorAll('input[type="checkbox"][value="low"]:checked, input[type="checkbox"][value="medium"]:checked, input[type="checkbox"][value="high"]:checked')).map(cb => cb.value);
    const materialFilters = Array.from(document.querySelectorAll('input[type="checkbox"][value="vetro"]:checked, input[type="checkbox"][value="metallo"]:checked, input[type="checkbox"][value="oro"]:checked')).map(cb => cb.value);

    const normalizedQuery = (activeSearchQuery || '').toLowerCase().trim();

    products.forEach(product => {
        const pCat = product.getAttribute('data-category');
        const pPrice = product.getAttribute('data-price');
        const pMat = product.getAttribute('data-material');
        const title = (product.querySelector('h3')?.textContent || '').toLowerCase();
        const alt = (product.querySelector('img')?.getAttribute('alt') || '').toLowerCase();

        // Logica:
        // 1. La categoria deve corrispondere (o essere 'all')
        // 2. SE ci sono filtri prezzo, il prodotto deve averne uno selezionato
        // 3. SE ci sono filtri materiale, il prodotto deve averne uno selezionato
        
        const matchCat = (activeCategory === 'all' || activeCategory === pCat);
        const matchPrice = (priceFilters.length === 0 || priceFilters.includes(pPrice));
        const matchMat = (materialFilters.length === 0 || materialFilters.includes(pMat));
        const matchText = (normalizedQuery.length === 0) || (
            title.includes(normalizedQuery) ||
            pCat?.toLowerCase().includes(normalizedQuery) ||
            pMat?.toLowerCase().includes(normalizedQuery) ||
            alt.includes(normalizedQuery)
        );

        if (matchCat && matchPrice && matchMat && matchText) {
            product.style.display = 'block';
            visibleCount++;
            // Piccola animazione di entrata
            product.style.opacity = '0';
            setTimeout(() => product.style.opacity = '1', 50);
        } else {
            product.style.display = 'none';
        }
    });

    // Aggiorna contatore
    const countText = document.getElementById('results-count');
    if (visibleCount === 0) countText.innerText = "Nessun prodotto trovato.";
    else countText.innerText = `Mostrando ${visibleCount} prodotti`;
}

// Ricerca live nella pagina Prodotti
(function initSearchLive(){
    const overlay = document.getElementById('search-overlay');
    const input = overlay ? overlay.querySelector('input') : null;
    if (!input) return;
    input.addEventListener('input', (e) => {
        activeSearchQuery = e.target.value || '';
        applyAdvancedFilters();
    });
    input.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') toggleSearch();
    });
})();

// === WISHLIST FUNCTIONALITY ===
const productTemplateMap = {};

// Toast Notification
function showToast(message) {
    const toast = document.createElement('div');
    toast.innerText = message;
    toast.style.cssText = "position:fixed; bottom:20px; left:50%; transform:translateX(-50%); background:var(--color-accent); color:var(--color-bg-main); padding:12px 24px; border-radius:50px; z-index:999999; font-weight:bold; text-align:center; box-shadow:0 5px 15px rgba(0,0,0,0.3); animation: fadeInToast 0.3s ease-out, fadeOutToast 0.3s ease-in 2.7s forwards;";
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 3000);
}

function buildProductTemplateMap() {
    document.querySelectorAll('.product-item').forEach(item => {
        const id = item.getAttribute('data-product-id');
        if (id && !productTemplateMap[id]) productTemplateMap[id] = item;
    });
}

function wishlistLines() {
    const wishlist = getWishlist();
    if (!wishlist.length) return '';
    const names = wishlist
        .map(id => {
            const item = productTemplateMap[id];
            if (!item) return null;
            return item.querySelector('h3')?.textContent?.trim();
        })
        .filter(Boolean);
    return names.map((name, i) => `${i + 1}. ${name}`).join('%0A');
}

function sendWishlist(channel) {
    const lines = wishlistLines();
    if (!lines) {
        alert('La wishlist è vuota.');
        return;
    }
    if (channel === 'whatsapp') {
        window.open(`https://wa.me/?text=Ecco%20la%20mia%20wishlist%20Illustro%3A%0A${lines}`, '_blank');
    } else if (channel === 'mail') {
        window.location.href = `mailto:?subject=Wishlist%20Illustro&body=Ecco%20la%20mia%20wishlist%20Illustro%3A%0A${lines}`;
    }
}

function getWishlist() {
    const wishlist = localStorage.getItem('granfoluce_wishlist');
    return wishlist ? JSON.parse(wishlist) : [];
}

function saveWishlist(wishlist) {
    localStorage.setItem('granfoluce_wishlist', JSON.stringify(wishlist));
}

function toggleWishlist(productId, btnElement) {
    let wishlist = getWishlist();
    const index = wishlist.indexOf(productId);
    
    if (index > -1) {
        wishlist.splice(index, 1);
        btnElement.classList.remove('active');
        showToast("Rimosso dalla Wishlist");
    } else {
        wishlist.push(productId);
        btnElement.classList.add('active');
        showToast("Aggiunto alla Wishlist!");
        if (navigator.vibrate) { navigator.vibrate(50); }
    }
    
    saveWishlist(wishlist);
    renderWishlist();
}

function bindWishlistButton(btn) {
    if (btn.dataset.bound === 'true') return;
    const productItem = btn.closest('.product-item');
    const productId = productItem.getAttribute('data-product-id');
    const wishlist = getWishlist();
    if (wishlist.includes(productId)) btn.classList.add('active');

    btn.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        toggleWishlist(productId, btn);
    });
    btn.dataset.bound = 'true';
}

function initWishlist() {
    const wishlistBtns = document.querySelectorAll('.wishlist-btn');
    wishlistBtns.forEach(bindWishlistButton);
}

function renderWishlist() {
    const section = document.getElementById('wishlist');
    const grid = document.getElementById('wishlist-grid');
    const empty = document.getElementById('wishlist-empty');
    if (!section || !grid || !empty) return;

    const wishlist = getWishlist();
    grid.innerHTML = '';

    const wishlistChip = document.getElementById('wishlist-chip');

    if (wishlist.length === 0) {
        section.style.display = 'none';
        if (wishlistChip) wishlistChip.style.display = 'none';
        return;
    }

    section.style.display = 'block';
    empty.style.display = 'none';
    if (wishlistChip) wishlistChip.style.display = 'inline-block';

    wishlist.forEach(id => {
        const template = productTemplateMap[id];
        if (!template) return;
        const clone = template.cloneNode(true);
        clone.style.display = 'block';
        const btn = clone.querySelector('.wishlist-btn');
        if (btn) {
            btn.classList.add('active');
            bindWishlistButton(btn);
        }
        grid.appendChild(clone);
    });
}

// Inizializza wishlist al caricamento
window.addEventListener('DOMContentLoaded', () => {
    buildProductTemplateMap();
    initWishlist();
    renderWishlist();
    // Applica filtri iniziali anche se presente query di ricerca
    applyAdvancedFilters();
});
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const activeDesktop = document.querySelector('.nav-links a.active');
            if (!activeDesktop) return;
            const targetHref = activeDesktop.getAttribute('href');
            document.querySelectorAll('.mobile-menu a').forEach(link => {
                if (link.getAttribute('href') === targetHref) link.classList.add('active');
            });
        });

        // Image error fallback handler
        document.addEventListener('error', function(e) {
            if (e.target.tagName && e.target.tagName.toLowerCase() === 'img') {
                e.target.src = 'images/placeholder.png';
                e.target.alt = 'Immagine non disponibile';
            }
        }, true);

        // Native Share API
        async function shareProduct(title, text, url) {
            if (navigator.share) {
                try {
                    await navigator.share({ title: title, text: text, url: url });
                    console.log('Condiviso con successo');
                } catch (err) {
                    console.log('Condivisione annullata');
                }
            } else {
                navigator.clipboard.writeText(url);
                showToast("Link copiato negli appunti!");
            }
        }

        // Lightbox
        function openLightbox(elOrSrc) {
            const lb = document.getElementById('lightbox');
            const img = document.getElementById('lightbox-img');
            const caption = document.getElementById('lightbox-caption');
            const note = document.getElementById('lightbox-note');

            let src = '', title = '', desc = '';
            if (typeof elOrSrc === 'string') {
                src = elOrSrc;
                const imgEl = Array.from(document.querySelectorAll('img')).find(i => (i.currentSrc && i.currentSrc.includes(src)) || i.src.includes(src) || i.getAttribute('src') === src);
                const item = imgEl ? imgEl.closest('.product-item') : null;
                title = item?.querySelector('h3')?.textContent || '';
                desc = item?.querySelector('.p-3 p')?.textContent || imgEl?.alt || '';
            } else {
                const imgEl = elOrSrc;
                src = imgEl.src;
                const item = imgEl.closest('.product-item');
                title = item?.querySelector('h3')?.textContent || '';
                const ps = item ? item.querySelectorAll('.p-3 p') : [];
                desc = ps.length ? ps[0].textContent : imgEl.alt || '';
            }

            img.src = src;
            if (caption) caption.innerHTML = (title ? `<strong>${title}</strong>` : '') + (desc ? `<br>${desc}` : '');
            const item = (typeof elOrSrc === 'string')
                ? Array.from(document.querySelectorAll('img')).find(i => (i.currentSrc && i.currentSrc.includes(src)) || i.src.includes(src) || i.getAttribute('src') === src)?.closest('.product-item')
                : elOrSrc.closest('.product-item');
            const noteText = item?.getAttribute('data-note') || '';
            if (note) {
                note.innerHTML = noteText;
                note.style.display = noteText ? 'block' : 'none';
            }
            document.body.style.overflow = 'hidden';
            lb.style.display = 'flex';
        }
        function closeLightbox() {
            const lb = document.getElementById('lightbox');
            lb.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
    </script>
    <div id="lightbox" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:99999; align-items:center; justify-content:center;" onclick="closeLightbox()">
        <div class="lightbox-inner" style="display:flex; flex-direction:column; align-items:center; max-width:100%;" onclick="event.stopPropagation()">
            <img id="lightbox-img" src="" style="max-width:90%; max-height:80%; object-fit:contain; transition: transform 0.2s; cursor: zoom-out;">
            <div class="lightbox-caption" id="lightbox-caption" style="max-width:90%; margin:1rem auto 0; color:#fff; font-size:0.95rem; line-height:1.4; text-align:center;"></div>
            <div id="lightbox-note" class="lightbox-note" style="width:90%; margin:0.5rem auto 0; color:#fff; opacity:0.9; font-size:0.9rem; line-height:1.5; text-align:center; display:none;"></div>
        </div>
        <span style="position:absolute; top:20px; right:20px; color:white; font-size:2rem; cursor:pointer;" onclick="closeLightbox()">×</span>
        <span style="position:absolute; bottom:20px; width:100%; text-align:center; color:#888; font-size:0.8rem;">Tocca per chiudere</span>
    </div>
            <div class="store-bar">
                <a href="index.html" class="store-btn">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    Home
                </a>
                <a href="prodotti.html" class="store-btn">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16"></path></svg>
                    Prodotti
                </a>
                <a href="prodotti.html#wishlist" class="store-btn highlight">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                    Wishlist
                </a>
                <a href="https://wa.me/393385978768" class="store-btn">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                    WhatsApp
                </a>
            </div>
            <script src="nav-behavior.js"></script>
    <script>
    let lastScrollTop = 0;
    const navbar = document.querySelector('.navbar');
    
    window.addEventListener('scroll', function() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        
        // 1. LOGICA COLORE: Se scorri più di 50px, diventa VERDE. Altrimenti TRASPARENTE.
        if (scrollTop > 50) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }

        // 2. LOGICA NASCONDI/MOSTRA:
        // Se scorri GIÙ e non sei in cima -> Nascondi la barra
        if (scrollTop > lastScrollTop && scrollTop > navbar.offsetHeight) {
            navbar.classList.add('nav-hidden');
        } else {
            // Se scorri SU -> Mostra la barra
            navbar.classList.remove('nav-hidden');
        }
        
        lastScrollTop = scrollTop;
    });
    </script>
    <script>
        const hidePreloader = () => {
            const preloader = document.getElementById('preloader');
            if (preloader && !preloader.classList.contains('loaded')) {
                preloader.classList.add('loaded');
            }
        };
        window.addEventListener('load', () => {
            requestAnimationFrame(() => {
                setTimeout(hidePreloader, 80);
            });
        });
    </script>
    <script src="luxury.js"></script>
</body>
</html>
